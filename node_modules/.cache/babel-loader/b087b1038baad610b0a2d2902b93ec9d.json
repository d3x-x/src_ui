{"ast":null,"code":"import React,{Component}from'react';import moment from'moment-timezone';import rpc from'utils/rpc';import withPayment from'components/Common/with-payment';import PrimaryTitle from'components/Common/primary-title';import OutlineButton from'components/Common/outline-button';import Item from'./item';import ScrollControls from'./scroll';class Licenses extends Component{constructor(){super(...arguments);this.list=React.createRef();this.state={prices:{},licenses:{},updatePercent:50};}componentDidMount(){this.setState(()=>this.props.location.state);}isValidLicense(license){const date=this.state.licenses[license];return!!date&&moment().diff(date,'days')<=0;}getPrice(license){const{prices,licenses,updatePercent}=this.state;const price=prices[license];const isBought=!!licenses[license];return isBought?price-price/100*updatePercent:price;}async buy(name,payment){const{licenses}=this.state;await rpc.callServer('Licenses-Buy',[name,payment]);this.setState(()=>({licenses:{...licenses,[name]:moment().add(1,'months').toISOString()}}));}render(){const{prices}=this.state;return/*#__PURE__*/React.createElement(\"div\",{className:\"licenses\"},/*#__PURE__*/React.createElement(PrimaryTitle,{className:\"licenses_title\"},\"\\u041C\\u0435\\u0440i\\u044F\"),/*#__PURE__*/React.createElement(\"div\",{ref:this.list,className:\"licenses_items\"},Object.keys(prices).map(license=>/*#__PURE__*/React.createElement(Item,{key:license,name:license,price:this.getPrice(license),bought:this.isValidLicense(license),buy:()=>this.props.showPayment(this.buy.bind(this,license))}))),/*#__PURE__*/React.createElement(ScrollControls,{list:this.list}),/*#__PURE__*/React.createElement(OutlineButton,{className:\"licenses_close\",isClose:true},\"\\u0417\\u0430\\u043A\\u0440\\u0438\\u0442\\u0438\"));}}export default withPayment(Licenses);","map":null,"metadata":{},"sourceType":"module"}