{"ast":null,"code":"import React,{Component}from'react';import{IoAlbums}from'react-icons/io5';import{showNotification}from'utils/notifications';import rpc from'utils/rpc';import prettify from'utils/prettify';import PrimaryTitle from'components/Common/primary-title';import OutlineButton from'components/Common/outline-button';import GradientButton from'components/Common/gradient-button';import TotalPrice from'components/Common/total-price';import Products from'./products';import Quantity from'./quantity';export default class Workshop extends Component{constructor(){super(...arguments);this.state={materials:0,prices:{}};}componentDidMount(){this.setState(()=>this.props.location.state);}selectProduct(name){this.setState(()=>({selectedProduct:{name,amount:1}}));}changeAmountOfProduct(value){const{selectedProduct}=this.state;if(selectedProduct){this.setState(()=>({selectedProduct:{...selectedProduct,amount:value}}));}}getTotalPrice(){const{prices,selectedProduct}=this.state;return selectedProduct?selectedProduct.amount*prices[selectedProduct.name]:0;}async getProduct(){const{selectedProduct}=this.state;if(!selectedProduct)return;try{const materials=await rpc.callServer('FactionWorkshop-CraftItem',[selectedProduct.name,selectedProduct.amount]);this.setState(()=>({materials,selectedProduct:undefined}));showNotification('success','Вы успешно изготовили предмет');}catch(err){if(err.msg)showNotification('error',err.msg);}}render(){var _selectedProduct$amou;const{materials,prices,selectedProduct}=this.state;return/*#__PURE__*/React.createElement(\"div\",{className:\"workshop\"},/*#__PURE__*/React.createElement(\"div\",{className:\"workshop_container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"workshop_header\"},/*#__PURE__*/React.createElement(PrimaryTitle,{className:\"workshop_title\"},\"\\u041C\\u0430\\u0441\\u0442\\u0435\\u0440\\u0441\\u043A\\u0430\\u044F\"),/*#__PURE__*/React.createElement(\"div\",{className:\"workshop_balance\"},/*#__PURE__*/React.createElement(IoAlbums,null),/*#__PURE__*/React.createElement(\"span\",null,prettify.materials(materials)))),/*#__PURE__*/React.createElement(Products,{items:prices,selected:selectedProduct===null||selectedProduct===void 0?void 0:selectedProduct.name,selectItem:this.selectProduct.bind(this)}),/*#__PURE__*/React.createElement(Quantity,{value:(_selectedProduct$amou=selectedProduct===null||selectedProduct===void 0?void 0:selectedProduct.amount)!==null&&_selectedProduct$amou!==void 0?_selectedProduct$amou:0,select:this.changeAmountOfProduct.bind(this)})),/*#__PURE__*/React.createElement(\"div\",{className:\"workshop_footer\"},/*#__PURE__*/React.createElement(OutlineButton,{isClose:true},\"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C\"),/*#__PURE__*/React.createElement(TotalPrice,{className:\"workshop_price\",titleClassName:\"workshop_price-title\",value:this.getTotalPrice(),formatter:prettify.materials}),/*#__PURE__*/React.createElement(GradientButton,{onClick:this.getProduct.bind(this)},\"\\u0418\\u0437\\u0433\\u043E\\u0442\\u043E\\u0432\\u0438\\u0442\\u044C\")));}}","map":null,"metadata":{},"sourceType":"module"}