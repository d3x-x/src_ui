{"ast":null,"code":"import React,{Component}from'react';import{random}from'lodash';import rpc from'utils/rpc';import sound from'assets/audio/lockpick.mp3';import PrimaryTitle from'components/Common/primary-title';import OutlineButton from'components/Common/outline-button';import Hint from'components/Common/hint';import Circle from'./circle';import Locks from'./locks';export default class Lockpick extends Component{constructor(){super(...arguments);this.point=React.createRef();this.pointer=React.createRef();this.state={counter:0,need:6,rotations:{point:0,pointer:0}};}componentDidMount(){this.setState(()=>this.props.location.state);this.rotate('point',random(0,360));}rotate(element,deg){this.setState(state=>({rotations:{...state.rotations,[element]:deg}}));}getRotationAngle(element){const matrix=window.getComputedStyle(element).getPropertyValue('transform');const values=matrix.split('(')[1].split(')')[0].split(',');const a=+values[0];const b=+values[1];return Math.round(Math.atan2(b,a)*(180/Math.PI));}async onCircleClick(){if(!this.pointer.current||!this.point.current)return;const pointerAngle=this.getRotationAngle(this.pointer.current);const pointAngle=this.getRotationAngle(this.point.current);if(pointerAngle>pointAngle-20&&pointerAngle<pointAngle+20){await this.setState(state=>({counter:state.counter+1}));new Audio(sound).play();if(this.state.counter>=this.state.need)await rpc.callClient('Lockpick-Success');else this.rotate('point',random(0,360));}else{await rpc.callClient('Lockpick-Error');}}render(){const{rotations,counter,need}=this.state;return/*#__PURE__*/React.createElement(\"div\",{className:\"lockpick\"},/*#__PURE__*/React.createElement(PrimaryTitle,{className:\"lockpick_title\"},\"\\u0417\\u043B\\u0430\\u043C\\u0443\\u0432\\u0430\\u043D\\u043D\\u044F \\u0442\\u0440\\u0430\\u043D\\u0441\\u043F\\u043E\\u0440\\u0442\\u0443\"),/*#__PURE__*/React.createElement(\"div\",{className:\"lockpick_container\"},/*#__PURE__*/React.createElement(Circle,{point:this.point,pointer:this.pointer,rotations:rotations,onClick:this.onCircleClick.bind(this)}),/*#__PURE__*/React.createElement(Locks,{amount:need,opened:counter}),/*#__PURE__*/React.createElement(\"div\",{className:\"lockpick_info\"},/*#__PURE__*/React.createElement(Hint,{action:\"click\"},\"\\u041D\\u0430\\u0442\\u0438\\u0441\\u043D\\u0456\\u0442\\u044C \\u0443 \\u0446\\u0435\\u043D\\u0442\\u0440\\u0456 \\u043A\\u043E\\u043B\\u0430\"),/*#__PURE__*/React.createElement(\"p\",{className:\"lockpick_info-item\"},\"\\u0412\\u043B\\u0443\\u0447\\u0442\\u0435 \",/*#__PURE__*/React.createElement(\"b\",null,need),\" \",need>4?'раз':'раза',\" \\u0443 \\u043A\\u0456\\u043B\\u044C\\u0446\\u0435\"))),/*#__PURE__*/React.createElement(OutlineButton,{className:\"lockpick_close\",onClick:()=>rpc.callClient('Lockpick-Cancel')},\"\\u0417\\u0430\\u043A\\u0440\\u0438\\u0442\\u0438\"));}}","map":null,"metadata":{},"sourceType":"module"}