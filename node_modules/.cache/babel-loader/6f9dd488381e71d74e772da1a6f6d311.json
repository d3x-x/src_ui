{"ast":null,"code":"import React,{Component}from'react';import rpc from'utils/rpc';import{connect}from'react-redux';import{showNotification}from'utils/notifications';import withPayment from'components/Common/with-payment';import withRotation from'components/Common/with-rotation';import OutlineButton from'components/Common/outline-button';import Money from'components/HUD/money';import Categories from'./categories';import Items from'./items';import Color from'./color';import Hints from'./hints';import{items}from'./data';const initialState={prices:{},installedItem:-1,color:{r:0,g:0,b:0,a:0},colorMenu:false,scrollPosition:0};class Lsc extends Component{constructor(){super(...arguments);this.state=initialState;}componentDidMount(){this.setState(()=>this.props.location.state);this.fetchCustomItems();}async fetchCustomItems(){Object.entries(items).forEach(async _ref=>{let[name,data]=_ref;if(data.length)return;const amount=await rpc.callClient('LSC-GetModAmount',name);for(let index=0;index<=amount;index++){data.push(index?'custom':'default');}});}async openCategory(name){if(name!=='repair'&&items[name]&&items[name].length<=1){return showNotification('error','Немає доступних деталей');}const installed=await rpc.callClient('LSC-SetCategory',name);this.setState(()=>({activeCategory:name,installedItem:installed}));}toPrev(){this.setState(()=>({selectedItem:undefined,activeCategory:undefined,colorMenu:false,color:initialState.color}));}selectItem(id){const{activeCategory}=this.state;if(!activeCategory)return;if(activeCategory==='paint'||activeCategory==='neon'&&id){this.setState(()=>({colorMenu:true,selectedItem:id,color:initialState.color}));}else{this.setState(()=>({selectedItem:id,colorMenu:false}));}rpc.callClient('LSC-SetItem',id-1);}changeColor(color){this.setState(()=>({color}));rpc.callClient('LSC-SetColor',[Object.values(color)]);}async buy(payment){const{activeCategory,selectedItem,color}=this.state;if(typeof selectedItem!=='number')return;const data={name:activeCategory,model:selectedItem,color:Object.values(color)};await rpc.callServer('LSC-Buy',[data,payment]);const installed=await rpc.callClient('LSC-GetInstalledItem',activeCategory);this.setState(()=>({installedItem:installed}));}saveScrollPosition(value){this.setState(()=>({scrollPosition:value}));}render(){const{money}=this.props;const{activeCategory,selectedItem,installedItem,colorMenu,color,prices,scrollPosition}=this.state;return/*#__PURE__*/React.createElement(\"div\",{className:\"lsc\"},/*#__PURE__*/React.createElement(Hints,null),/*#__PURE__*/React.createElement(\"div\",{className:\"lsc_buttons\"},/*#__PURE__*/React.createElement(OutlineButton,{className:\"lsc_buttons-item lsc_buttons-item--prev\",disabled:!activeCategory,onClick:this.toPrev.bind(this)},/*#__PURE__*/React.createElement(\"span\",null,\"\\u043D\\u0430\\u0437\\u0430\\u0434\")),selectedItem!==undefined&&selectedItem-1!==installedItem?/*#__PURE__*/React.createElement(OutlineButton,{className:\"lsc_buttons-item\",onClick:()=>this.props.showPayment(this.buy.bind(this))},/*#__PURE__*/React.createElement(\"span\",null,\"\\u041A\\u0443\\u043F\\u0438\\u0442\\u0438\")):/*#__PURE__*/React.createElement(OutlineButton,{className:\"lsc_buttons-item\",onClick:()=>rpc.callClient('LSC-CloseMenu')},/*#__PURE__*/React.createElement(\"span\",null,\"\\u0417\\u0430\\u043A\\u0440\\u0438\\u0442\\u0438\"))),activeCategory?/*#__PURE__*/React.createElement(Items,{category:activeCategory,items:items[activeCategory],prices:prices[activeCategory],selected:selectedItem,installed:installedItem,select:this.selectItem.bind(this)}):/*#__PURE__*/React.createElement(Categories,{current:activeCategory,offset:scrollPosition,open:this.openCategory.bind(this),onScroll:this.saveScrollPosition.bind(this)}),colorMenu&&/*#__PURE__*/React.createElement(Color,{state:color,custom:activeCategory==='paint'&&selectedItem===2,typeSelector:activeCategory==='paint'&&[0,1].includes(selectedItem!==null&&selectedItem!==void 0?selectedItem:-1),onChange:this.changeColor.bind(this)}),/*#__PURE__*/React.createElement(Money,{cash:money.cash,bank:money.bank}));}}const mapStateToProps=state=>({money:state.player.money});export default connect(mapStateToProps,{})(withPayment(withRotation(Lsc)));","map":null,"metadata":{},"sourceType":"module"}