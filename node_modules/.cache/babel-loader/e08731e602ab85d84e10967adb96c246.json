{"ast":null,"code":"import $ from '../../shared/dom7';\nimport { bindMethods } from '../../shared/utils';\nvar InfiniteScroll = {\n  handle: function handle(el, e) {\n    var app = this;\n    var $el = $(el);\n    var scrollTop = $el[0].scrollTop;\n    var scrollHeight = $el[0].scrollHeight;\n    var height = $el[0].offsetHeight;\n    var distance = $el[0].getAttribute('data-infinite-distance');\n    var virtualListContainer = $el.find('.virtual-list');\n    var virtualList;\n    var onTop = $el.hasClass('infinite-scroll-top');\n    if (!distance) distance = 50;\n    if (typeof distance === 'string' && distance.indexOf('%') >= 0) {\n      distance = parseInt(distance, 10) / 100 * height;\n    }\n    if (distance > height) distance = height;\n    if (onTop) {\n      if (scrollTop < distance) {\n        $el.trigger('infinite', e);\n        app.emit('infinite', $el[0], e);\n      }\n    } else if (scrollTop + height >= scrollHeight - distance) {\n      if (virtualListContainer.length > 0) {\n        virtualList = virtualListContainer.eq(-1)[0].f7VirtualList;\n        if (virtualList && !virtualList.reachEnd && !virtualList.params.updatableScroll) {\n          return;\n        }\n      }\n      $el.trigger('infinite', e);\n      app.emit('infinite', $el[0], e);\n    }\n  },\n  create: function create(el) {\n    var $el = $(el);\n    var app = this;\n    function scrollHandler(e) {\n      app.infiniteScroll.handle(this, e);\n    }\n    $el.each(function (element) {\n      element.f7InfiniteScrollHandler = scrollHandler;\n      element.addEventListener('scroll', element.f7InfiniteScrollHandler);\n    });\n  },\n  destroy: function destroy(el) {\n    var $el = $(el);\n    $el.each(function (element) {\n      element.removeEventListener('scroll', element.f7InfiniteScrollHandler);\n      delete element.f7InfiniteScrollHandler;\n    });\n  }\n};\nexport default {\n  name: 'infiniteScroll',\n  create: function create() {\n    var app = this;\n    bindMethods(app, {\n      infiniteScroll: InfiniteScroll\n    });\n  },\n  on: {\n    tabMounted: function tabMounted(tabEl) {\n      var app = this;\n      var $tabEl = $(tabEl);\n      var $isEls = $tabEl.find('.infinite-scroll-content');\n      if ($tabEl.is('.infinite-scroll-content')) $isEls.add($tabEl);\n      $isEls.each(function (el) {\n        app.infiniteScroll.create(el);\n      });\n    },\n    tabBeforeRemove: function tabBeforeRemove(tabEl) {\n      var $tabEl = $(tabEl);\n      var app = this;\n      var $isEls = $tabEl.find('.infinite-scroll-content');\n      if ($tabEl.is('.infinite-scroll-content')) $isEls.add($tabEl);\n      $isEls.each(function (el) {\n        app.infiniteScroll.destroy(el);\n      });\n    },\n    pageInit: function pageInit(page) {\n      var app = this;\n      page.$el.find('.infinite-scroll-content').each(function (el) {\n        app.infiniteScroll.create(el);\n      });\n    },\n    pageBeforeRemove: function pageBeforeRemove(page) {\n      var app = this;\n      page.$el.find('.infinite-scroll-content').each(function (el) {\n        app.infiniteScroll.destroy(el);\n      });\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module"}